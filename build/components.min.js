var components=angular.module("components",["components.grid","components.pick","components.spinner"]),ngGrid=angular.module("components.grid",[]).directive("ngGrid",function(){return{priority:1200,restrict:"E",compile:function(a,b){b.columns=a.find("column")},controller:["$attrs",function(a){this.columns=a.columns}]}}).filter("gridSlice",function(){return function(a,b,c){return a.slice(b,c)}}).directive("ngGrid",function(){return{priority:1100,restrict:"E",replace:!0,scope:{title:"@",rows:"@",varr:"@var",input:"=",output:"="},link:function(a,b){a.index=1,a.predicate="name",a.reverse=!1,a.firstItem=0,a.lastItem=a.input.length,a.filteredList=[],a.selectedAll=!1,a.indeterminate=!1,a.paginate=[];{var c;!function(){var b;angular.forEach(a.output,function(c){b=a.input.indexOf(c),-1==b&&a.output.splice(b,1)})}()}a.pagesCount=function(){var b,d=[],e=a.index-2;if(a.rows){c=Math.ceil(a.filteredList.length/parseInt(a.rows)),e>c-4&&(e=c-4),0>=e&&(e=1),b=e+5,b>c&&(b=c+1);for(var f=e;b>f;f++)d.push(f)}return d},a.goPage=function(b){a.rows&&(a.firstItem=(b-1)*parseInt(a.rows),a.lastItem=a.firstItem+parseInt(a.rows),a.lastItem>a.input.length&&(a.lastItem=a.input.length),a.index=b)},a.getFirstItem=function(){var b=(a.index-1)*parseInt(a.rows);return b>a.filteredList.length?0:b+1},a.getLastItem=function(){var b=a.getFirstItem(a.filteredList.length)+parseInt(a.rows)-1;return a.getFirstItem(a.filteredList.length)?b>a.filteredList.length?a.filteredList.length:b:0},a.disabledLeft=function(){return 1==a.index?"disabled":""},a.disabledRight=function(){return a.index==c?"disabled":""},a.first=function(){a.goPage(1)},a.last=function(){a.goPage(c)},a.prev=function(){1!=a.index&&a.goPage(--a.index)},a.next=function(){a.index!=c&&a.goPage(++a.index)},a.currentPage=function(b){return a.index==b?"active":""},a.orderBy=function(b){a.predicate==b?a.reverse=!a.reverse:(a.predicate=b,a.reverse=!1)},a.orderIcon=function(b){return a.predicate==b?a.reverse?"glyphicon glyphicon-chevron-down":"glyphicon glyphicon-chevron-up":""},a.toggleSelection=function(b){var c;c=a.output.indexOf(b),c>-1?a.output.splice(c,1):a.output.push(b)},a.toggleSelectionAll=function(b){a.selectedAll=!a.selectedAll,angular.forEach(b,function(b){idx=a.output.indexOf(b),a.selectedAll?-1==idx&&a.output.push(b):idx>-1&&a.output.splice(idx,1)})};var d=function(b,c){var d,e=!1,f=!1;return c?(angular.forEach(b,function(b){return d=c.indexOf(b),d>-1?e=!0:f=!0,e&&f?(a.selectedAll=!0,void(a.indeterminate=!0)):void 0}),e&&!f?(a.selectedAll=!0,void(a.indeterminate=!1)):!e&&f?(a.selectedAll=!1,void(a.indeterminate=!1)):void 0):void 0};a.$watch("input | filter:search:strict",function(b){a.filteredList=b,d(b,a.output)},!0),a.$watch("output",function(b){d(a.filteredList,b)},!0);{var e=function(){angular.forEach(b.find("tr")[1].childNodes,function(a,c){b.find("thead")[0].childNodes[0].childNodes[c].style.width=a.offsetWidth+"px"}),f()},f=function(){var a=(document.body.scrollTop,b.find("table")[0].getBoundingClientRect().top+20),c=a+b.find("table")[0].offsetHeight-100;b.find("thead")[0].childNodes[0].style.display=0>=a&&c>0?"":"none"};!function(){e()}()}a.$watch(function(){e()},!0),angular.element(window).bind("resize",function(){a.$apply(),e()}),angular.element(window).bind("scroll",function(){a.$apply(),f()}),a.goPage(1)},template:'<div class="ng-table panel panel-default"><div class="panel-heading" ng-if="title"><label ng-bind="title"></label></div><table class="table table-striped table-hover"><thead title-grid-transclude></thead><tbody><tr ng-repeat="item in input | orderBy:predicate:reverse | filter:search:strict | gridSlice:firstItem:lastItem" ng-class="{info:output.indexOf(item) > -1}" row-grid-transclude></tbody></table><div class="panel-footer"><div class="row"><div class="col-md-4"><p class="text-muted" style="margin: 4px;"><span class="label label-default" ng-if="rows">{{getFirstItem();}}/{{getLastItem();}}</span><span> {{filteredList.length}}</span><span ng-hide="!output.length">/</span><span ng-hide="!output.length">{{output.length}}</span></p></div><div class="col-md-8" style="text-align:right;" ng-if="rows"><ul class="pagination pagination-sm" style="margin:0px;"><li ng-class="disabledLeft();"><a href="javascript:;" ng-click="first()">&laquo;&laquo;</a></li><li ng-class="disabledLeft();"><a href="javascript:;" ng-click="prev()">&laquo;</a></li><li ng-repeat="i in pagesCount()" ng-class="currentPage(i);"><a href="javascript:;" ng-click="goPage(i)" ng-bind="i"></a></li><li ng-class="disabledRight();"><a href="javascript:;" ng-click="next()">&raquo;</a></li><li ng-class="disabledRight();"><a href="javascript:;" ng-click="last()">&raquo;&raquo;</a></li></ul></div></div></div></div>'}}).directive("ngIndeterminate",[function(){return{scope:!0,require:"^ngGrid",restrict:"A",link:function(a,b,c){a.$watch(c.ngIndeterminate,function(a){b.prop("indeterminate",a)})}}}]).directive("titleGridTransclude",["$compile",function(a){return{require:"^ngGrid",link:function(b,c,d,e){var f,g,h,i=[],j=!1,k=document.createElement("th"),l=document.createElement("tr"),m=document.createElement("th"),n=document.createElement("tr");b.output&&(k.innerHTML='<p><input class="btn text-center" ng-indeterminate="indeterminate" type="checkbox" ng-model="selectedAll" ng-click="toggleSelectionAll((input | filter:search:strict))"></p>',k.style.width="50px",k.style.textAlign="center",l.appendChild(k),n.appendChild(m)),angular.forEach(e.columns,function(a){spanCaption="",f="",g="",k=document.createElement("th"),m=document.createElement("th"),a&&a.attributes&&a.attributes.width&&a.attributes.width.value&&(k.style.width=a.attributes.width.value,m.style.width=a.attributes.width.value),a&&a.attributes&&a.attributes.caption&&a.attributes.caption.value&&(g=a.attributes.caption.value,spanCaption="<p><span>"+g+"</span></p>"),a&&a.attributes&&a.attributes.order&&a.attributes.order.value&&(spanCaption="<p><span ng-click=\"orderBy('"+a.attributes.order.value+'\');"><a href="">'+g+" <span ng-class=\"orderIcon('"+a.attributes.order.value+"');\"></span></a></span></p>"),a&&a.attributes&&a.attributes.filter&&a.attributes.filter.value&&(f='<p><input class="form-control" ng-model="search.'+a.attributes.filter.value+'"></p>',j=!0),k.innerHTML=spanCaption,m.innerHTML=f,n.appendChild(m),l.appendChild(k)}),h=l.cloneNode(!0),h.className="scrollHeader",h.style.display="none",h.style.background="white",h.style.top="0",h.style.position="fixed",i.push(h),i.push(l),j&&i.push(n),c.append(i),a(i)(b)}}}]).directive("rowGridTransclude",["$compile",function(a){return{require:"^ngGrid",link:function(b,c,d,e){var f,g,h,i=/{{([^}]*)}}/g,j=[],k=document.createElement("td");b.output&&(k.innerHTML='<p><input class="btn text-center" type="checkbox" value="{{item}}" ng-checked="output.indexOf(item) > -1" ng-click="toggleSelection(item, (input | filter:search:strict))"></p>',k.style.textAlign="center",j.push(k)),angular.forEach(e.columns,function(a){for(k=document.createElement("td"),a&&a.attributes&&a.attributes.width&&a.attributes.width.value&&(k.style.width=a.attributes.width.value),k.innerHTML=a.innerHTML;null!==(f=i.exec(k.innerHTML));)g=f[0],h=f[1],h=h.replace(b.varr,"item"),k.innerHTML=k.innerHTML.replace(g,"{{"+h+"}}");if(k.childNodes&&k.childNodes.length>0)for(var c=0;c<k.childNodes.length;c++)if(k.childNodes[c].attributes&&k.childNodes[c].attributes.length>0)for(var d=0;d<k.childNodes[c].attributes.length;d++)0===k.childNodes[c].attributes[d].name.indexOf("ng-")&&(k.childNodes[c].attributes[d].value=k.childNodes[c].attributes[d].value.replace(b.varr,"item"));j.push(k)}),c.append(j),a(j)(b)}}}]),ngPick=angular.module("components.pick",[]).directive("ngPick",function(){return{priority:1200,restrict:"E",compile:function(a,b){b.orderControlVisible="false"==b.orderControlVisible?!1:!0,b.columns=a.find("column")},controller:["$attrs",function(a){this.columns=a.columns}]}}).directive("ngPick",function(){return{priority:1100,restrict:"E",replace:!0,scope:{inputTitle:"@",outputTitle:"@",listHeight:"@",listWidth:"@",varr:"@var",addAllLabel:"@",addLabel:"@",removeLabel:"@",removeAllLabel:"@",orderControlVisible:"@",firstLabel:"@",upLabel:"@",downLabel:"@",lastLabel:"@",input:"=",output:"="},link:function(a){a.inputItem=null,a.outputItem=null;var b=function(a,b){var c=b.indexOf(a);c>-1&&b.splice(c,1)},c=function(a,b,c){var d=b.indexOf(a);b.splice(d+c,0,b.splice(d,1)[0])};a.selectInputItem=function(b){a.inputItem=b,a.outputItem=null},a.selectOutputItem=function(b){a.outputItem=b,a.inputItem=null},a.selectAndAddInputItem=function(b){a.inputItem=b,a.add()},a.selectAndRemoveOutputItem=function(b){a.outputItem=b,a.remove()},a.addAll=function(){a.output=a.output.concat(a.input),a.input=[],a.inputItem=null},a.add=function(){b(a.inputItem,a.input),a.output.push(a.inputItem),a.inputItem=null},a.remove=function(){b(a.outputItem,a.output),a.input.push(a.outputItem),a.outputItem=null},a.removeAll=function(){a.input=a.input.concat(a.output),a.output=[],a.outputItem=null},a.hasInput=function(){return a.input.length},a.hasOutput=function(){return a.output.length},a.hasInputItem=function(){return a.inputItem},a.hasOutputItem=function(){return a.outputItem},a.isFirst=function(){return!a.hasOutputItem()||a.output[0]===a.outputItem},a.isLast=function(){return!a.hasOutputItem()||a.output[a.output.length-1]===a.outputItem},a.first=function(){b(a.outputItem,a.output),a.output.unshift(a.outputItem)},a.up=function(){c(a.outputItem,a.output,-1)},a.down=function(){c(a.outputItem,a.output,1)},a.last=function(){b(a.outputItem,a.output),a.output.push(a.outputItem)}},template:'<table class="ng-pick"><tr><td><strong>{{inputTitle}}</strong></td><td></td><td><strong>{{outputTitle}}</strong></td><td></td></tr><tr><td ng-style="{width: listWidth || \'240px\'}"><div class="panel panel-default"><table class="table"><thead><tr title-transclude></tr></thead></table><div style="overflow-y:auto;overflow-x:hidden;" ng-style="{height: listHeight || \'200px\'}"><table class="table table-striped table-hover"><tbody><tr ng-repeat="item in input" ng-click="selectInputItem(item)" ng-dblclick="selectAndAddInputItem(item)" ng-class="{info:item === inputItem}" row-transclude></tbody></table></div></div></td><td><div class="btn-group-vertical"  style="min-width:100px;padding:10px;"><button type="button" ng-click="addAll()" ng-disabled="!hasInput()" class="btn btn-primary">{{addAllLabel || "Adicionar Todos"}}</button><button type="button" ng-click="add()" ng-disabled="!hasInputItem()" class="btn btn-primary">{{addLabel || "Adicionar Item"}}</button><button type="button" ng-click="remove()" ng-disabled="!hasOutputItem()" class="btn btn-primary">{{removeLabel || "Remover Item"}}</button><button type="button" ng-click="removeAll()" ng-disabled="!hasOutput()" class="btn btn-primary">{{removeAllLabel || "Remover Todos"}}</button></div></td><td ng-style="{width: listWidth || \'240px\'}"><div class="panel panel-default"><table class="table"><thead><tr title-transclude></tr></thead></table><div style="overflow-y:auto;overflow-x:hidden;" ng-style="{height: listHeight || \'200px\'}"><table class="table table-striped table-hover"><tbody><tr ng-repeat="item in output | orderBy:predicateOutput:reverseOutput" ng-click="selectOutputItem(item)" ng-dblclick="selectAndRemoveOutputItem(item)" ng-class="{info:item === outputItem}" row-transclude></tbody></table></div></div></td><td ng-if="orderControlVisible"><div class="btn-group-vertical" style="min-width:100px;padding:10px;"><button type="button" ng-click="first()" ng-disabled="isFirst()" class="btn btn-primary">{{firstLabel || "Primeiro"}}</button><button type="button" ng-click="up()" ng-disabled="isFirst()" class="btn btn-primary">{{upLabel || "Sobe"}}</button><button type="button" ng-click="down()" ng-disabled="isLast()" class="btn btn-primary">{{downLabel || "Desce"}}</button><button type="button" ng-click="last()" ng-disabled="isLast()" class="btn btn-primary">{{lastLabel || "Último"}}</button></div></td></tr></table>'}}).directive("titleTransclude",["$compile",function(a){return{require:"^ngPick",link:function(b,c,d,e){var f=[];angular.forEach(e.columns,function(a){var b=document.createElement("th");a&&a.attributes&&a.attributes.width&&a.attributes.width.value&&(b.style.width=a.attributes.width.value),b.innerHTML=a.attributes.caption.value,f.push(b)}),c.append(f),a(f)(b)}}}]).directive("rowTransclude",["$compile",function(a){return{require:"^ngPick",link:function(b,c,d,e){var f,g,h,i=/{{([^}]*)}}/g,j=[];if(angular.forEach(e.columns,function(a){var c=document.createElement("td");for(a&&a.attributes&&a.attributes.width&&a.attributes.width.value&&(c.style.width=a.attributes.width.value),c.innerHTML=a.innerHTML;null!==(f=i.exec(c.innerHTML));)g=f[0],h=f[1],h=h.replace(b.varr,"item"),c.innerHTML=c.innerHTML.replace(g,"{{"+h+"}}");if(c.childNodes&&c.childNodes.length>0)for(var d=0;d<c.childNodes.length;d++)if(c.childNodes[d].attributes&&c.childNodes[d].attributes.length>0)for(var e=0;e<c.childNodes[d].attributes.length;e++)0===c.childNodes[d].attributes[e].name.indexOf("ng-")&&(c.childNodes[d].attributes[e].value=c.childNodes[d].attributes[e].value.replace(b.varr,"item"));j.push(c)}),!e.columns||0===e.columns.length){var k=document.createElement("td");k.innerHTML="{{item}}",j.push(k)}c.append(j),a(j)(b)}}}]),ngPick=angular.module("components.spinner",[]).directive("ngSpinner",function(){return{restrict:"E",replace:!0,scope:{min:"@",max:"@",step:"@",prefix:"@",postfix:"@",decimals:"@",varr:"=var"},link:function(a){var b,c=250,d=function(a,b){return b?a.toFixed(b):a},e=function(f,g){if(f){if(a.max&&a.varrReal+a.realStep>a.max)return;a.varrReal+=a.realStep,clearInterval(b),b=setInterval(e,c,!0,!1)}else{if(a.min&&a.varrReal-a.realStep<a.min)return;a.varrReal-=a.realStep,clearInterval(b),b=setInterval(e,c,!1,!1)}a.varr=d(a.varrReal,a.decimals),c>50&&(c-=20),g||a.$apply()};a.sum=function(){e(!0,!0)},a.sub=function(){e(!1,!0)},a.up=function(){clearInterval(b),c=250},a.realStep=a.step?parseFloat(a.step):1,a.varrReal=parseFloat(a.varr),a.varr=d(a.varrReal,a.decimals)},template:'<div class="input-group"><span class="input-group-btn"><button class="btn btn-default" type="button" ng-mousedown="sub()" ng-mouseup="up()" ng-mouseleave="up()">-</button></span><span class="input-group-addon" ng-If="prefix" ng-bind="prefix"></span><input type="text" class="form-control" style="display: block;" ng-model="varr"><span class="input-group-addon" ng-If="postfix" ng-bind="postfix"></span><span class="input-group-btn"><button class="btn btn-default" type="button" ng-mousedown="sum()" ng-mouseup="up()" ng-mouseleave="up()">+</button></span></div>'}});